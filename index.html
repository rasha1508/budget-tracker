<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wedding Budget Overview</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary-color: #d4a5a5;
      --secondary-color: #f8f4f1;
      --accent-color: #fdfaf7;
      --text-color: #6d4c41;
      --light-text: #8d6e63;
      --border-color: rgba(212, 165, 165, 0.15);
      --white: #ffffff;
      --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      --heart-empty: #e0e0e0;
      --heart-filled: #d4a5a5;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: "Inter", sans-serif;
      background-color: transparent;
      color: var(--text-color);
      line-height: 1.5;
      padding: 10px;
      font-weight: 400;
    }
    
    .overview-container {
      max-width: 400px;
      margin: 0 auto;
      background: var(--white);
      border-radius: 8px;
      box-shadow: var(--card-shadow);
      overflow: hidden;
      border: 1px solid var(--border-color);
    }
    
    .overview-content {
      padding: 12px;
    }
    
    .budget-summary {
      background: var(--accent-color);
      border-radius: 6px;
      padding: 10px;
      margin-bottom: 12px;
      border: 1px solid var(--border-color);
    }
    
    .budget-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    
    .budget-title {
      font-weight: 500;
      color: var(--text-color);
      font-size: 0.9rem;
    }
    
    .budget-amount {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }
    
    .heart-progress-container {
      margin: 10px 0;
      text-align: center;
    }
    
    .heart-progress-bar {
      display: flex;
      justify-content: center;
      flex-wrap: nowrap;
      overflow: hidden;
      width: 150px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .heart {
      width: 12px;
      height: 12px;
      margin: 0 1px;
      transition: fill 0.5s ease, transform 0.3s ease;
      flex-shrink: 0;
    }
    
    .heart.filled {
      transform: scale(1.2);
    }
    
    .progress-percentage {
      font-size: 0.75rem;
      color: var(--light-text);
      margin-top: 6px;
    }
    
    .budget-stats {
      display: flex;
      justify-content: space-between;
      font-size: 0.75rem;
      color: var(--light-text);
    }
    
    .unpaid-section {
      margin-top: 12px;
    }
    
    .section-title {
      font-size: 0.95rem;
      margin-bottom: 8px;
      color: var(--text-color);
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .unpaid-list {
      border: 1px solid var(--border-color);
      border-radius: 4px;
      overflow: hidden;
    }
    
    .unpaid-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .unpaid-item:last-child {
      border-bottom: none;
    }
    
    .unpaid-info {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .unpaid-icon {
      width: 24px;
      height: 24px;
      background: var(--secondary-color);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary-color);
      font-size: 0.8rem;
    }
    
    .unpaid-details h4 {
      font-size: 0.8rem;
      margin: 0 0 2px;
      color: var(--text-color);
      font-weight: 500;
    }
    
    .unpaid-details p {
      font-size: 0.7rem;
      margin: 0;
      color: var(--light-text);
    }
    
    .unpaid-amount {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.85rem;
    }
    
    .empty-state {
      text-align: center;
      padding: 12px;
      color: var(--light-text);
    }
    
    .empty-state i {
      font-size: 1.4rem;
      margin-bottom: 6px;
      color: var(--primary-color);
    }
    
    .empty-state p {
      font-size: 0.8rem;
    }
    
    .status-pending {
      background: #ffe0b2;
      color: #e65100;
      font-size: 0.65rem;
      padding: 1px 4px;
      border-radius: 3px;
      font-weight: 500;
    }
  </style>
</head>
<body>
  <div class="overview-container">
    <div class="overview-content">
      <!-- Budget Summary -->
      <div class="budget-summary">
        <div class="budget-header">
          <span class="budget-title">Total Budget</span>
          <span class="budget-amount" id="total-budget-display">$0.00</span>
        </div>
        
        <!-- Heart Progress Bar -->
        <div class="heart-progress-container">
          <div class="heart-progress-bar" id="heart-progress-bar">
            <!-- Hearts will be generated by JavaScript -->
          </div>
          <div class="progress-percentage" id="progress-percentage">0% spent</div>
        </div>
        
        <div class="budget-stats">
          <span>Spent: <span id="total-spent">$0.00</span></span>
          <span>Remaining: <span id="budget-remaining">$0.00</span></span>
        </div>
      </div>
      
      <!-- Unpaid Expenses -->
      <div class="unpaid-section">
        <h2 class="section-title">
          <i class="fas fa-exclamation-circle"></i> Unpaid Expenses
        </h2>
        <div class="unpaid-list" id="unpaid-list">
          <div class="empty-state">
            <i class="fas fa-check-circle"></i>
            <p>All expenses have been paid!</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Elements
      const totalBudgetDisplay = document.getElementById("total-budget-display");
      const totalSpentDisplay = document.getElementById("total-spent");
      const budgetRemainingDisplay = document.getElementById("budget-remaining");
      const heartProgressBar = document.getElementById("heart-progress-bar");
      const progressPercentage = document.getElementById("progress-percentage");
      const unpaidList = document.getElementById("unpaid-list");
      
      // Data
      let totalBudget = 0;
      let expenses = [];
      
      // Category icons
      const categoryIcons = {
        venue: "fas fa-building",
        catering: "fas fa-utensils",
        photography: "fas fa-camera",
        attire: "fas fa-tshirt",
        flowers: "fas fa-heart",
        music: "fas fa-music",
        decorations: "fas fa-paint-brush",
        rings: "fas fa-ring",
        other: "fas fa-ellipsis-h",
      };
      
      // Category names
      const categoryNames = {
        venue: "Venue",
        catering: "Catering",
        photography: "Photography",
        attire: "Attire",
        flowers: "Flowers",
        music: "Music & Entertainment",
        decorations: "Decorations",
        rings: "Rings",
        other: "Other",
      };
      
      // SVG Heart Icon
      const heartSVG = `
        <svg class="heart" viewBox="0 0 24 24" fill="var(--heart-empty)">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
      `;
      
      // Initialize heart progress bar
      function initializeHeartBar() {
        heartProgressBar.innerHTML = '';
        // Create 10 small hearts
        for (let i = 0; i < 10; i++) {
          const heartElement = document.createElement('div');
          heartElement.innerHTML = heartSVG;
          heartElement.setAttribute('data-heart', i);
          heartProgressBar.appendChild(heartElement);
        }
      }
      
      // Load from local storage
      function loadData() {
        const savedBudget = localStorage.getItem("weddingTotalBudget");
        const savedExpenses = localStorage.getItem("weddingExpenses");
        
        if (savedBudget) {
          totalBudget = parseFloat(savedBudget);
        }
        
        if (savedExpenses) {
          expenses = JSON.parse(savedExpenses);
        }
        
        updateBudgetDisplay();
        renderUnpaidList();
      }
      
      // Update budget display
      function updateBudgetDisplay() {
        const totalSpent = expenses.reduce((sum, expense) => sum + expense.amount, 0);
        const remaining = totalBudget - totalSpent;
        
        totalBudgetDisplay.textContent = formatCurrency(totalBudget);
        totalSpentDisplay.textContent = formatCurrency(totalSpent);
        budgetRemainingDisplay.textContent = formatCurrency(remaining);
        
        // Update heart progress bar
        updateHeartProgress(totalSpent, totalBudget);
      }
      
      // Update heart progress bar
      function updateHeartProgress(spent, budget) {
        // Calculate percentage
        let percentage = 0;
        if (budget > 0) {
          percentage = Math.min(100, (spent / budget) * 100);
        }
        
        // Update percentage text
        progressPercentage.textContent = `${Math.round(percentage)}% spent`;
        
        // Calculate how many hearts to fill (10 hearts total)
        const heartsToFill = Math.round((percentage / 100) * 10);
        
        // Reset all hearts to empty
        const heartElements = heartProgressBar.querySelectorAll('.heart');
        heartElements.forEach(heart => {
          heart.setAttribute('fill', 'var(--heart-empty)');
          heart.classList.remove('filled');
        });
        
        // Fill hearts up to the calculated number
        for (let i = 0; i < heartsToFill && i < heartElements.length; i++) {
          heartElements[i].setAttribute('fill', 'var(--heart-filled)');
          heartElements[i].classList.add('filled');
        }
      }
      
      // Format currency
      function formatCurrency(amount) {
        return new Intl.NumberFormat("en-US", {
          style: "currency",
          currency: "USD",
          minimumFractionDigits: 2,
        }).format(amount);
      }
      
      // Render unpaid expenses list
      function renderUnpaidList() {
        const unpaidExpenses = expenses.filter(expense => expense.status === "pending");
        
        if (unpaidExpenses.length === 0) {
          unpaidList.innerHTML = `
            <div class="empty-state">
              <i class="fas fa-check-circle"></i>
              <p>All expenses have been paid!</p>
            </div>
          `;
          return;
        }
        
        unpaidList.innerHTML = "";
        
        // Sort by amount (highest first)
        unpaidExpenses.sort((a, b) => b.amount - a.amount);
        
        unpaidExpenses.forEach(expense => {
          const unpaidItem = document.createElement("div");
          unpaidItem.className = "unpaid-item";
          unpaidItem.innerHTML = `
            <div class="unpaid-info">
              <div class="unpaid-icon">
                <i class="${categoryIcons[expense.category]}"></i>
              </div>
              <div class="unpaid-details">
                <h4>${expense.name}</h4>
                <p>${categoryNames[expense.category]}</p>
              </div>
            </div>
            <div>
              <div class="unpaid-amount">${formatCurrency(expense.amount)}</div>
              <div class="status-pending">Pending</div>
            </div>
          `;
          unpaidList.appendChild(unpaidItem);
        });
      }
      
      // Listen for storage changes to sync with main tracker
      window.addEventListener('storage', (event) => {
        if (event.key === 'weddingExpenses' || event.key === 'weddingTotalBudget') {
          loadData();
        }
      });
      
      // Also listen for custom storage events (from same window)
      window.addEventListener('weddingDataUpdated', () => {
        loadData();
      });
      
      // Initialize
      initializeHeartBar();
      loadData();
    });
  </script>
</body>
</html>
